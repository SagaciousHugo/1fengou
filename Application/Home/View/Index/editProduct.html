<extend name="Base/common"/>

<block name="defineScript">
    <script type="text/javascript">
        /*alert('jQuery版本：' + $.fn.jquery);*/
        $(function() {
            /*
             表单验证初始化
             */
            $("#commentForm").validate();

            /*
             使用H5的API进行商品缩略图读取和预览
             */
            var
                    fileInput = document.getElementById('test-image-file'),
                    info = document.getElementById('test-file-info'),
                    preview = document.getElementById('test-image-preview');
            // 监听change事件:
            fileInput.addEventListener('change', function () {
                // 清除背景图片:
                preview.style.backgroundImage = '';
                // 检查文件是否选择:
                if (!fileInput.value) {
                    info.innerHTML = '没有选择文件';
                    return;
                }
                // 获取File引用:
                var file = fileInput.files[0];
                // 获取File信息:
                info.innerHTML = '缩略图信息' + '<br>' + '文件: ' + file.name + '<br>' +
                        '大小: ' + file.size + '<br>' +
                        '修改: ' + file.lastModifiedDate;
                if (file.type !== 'image/jpeg' && file.type !== 'image/png' && file.type !== 'image/gif') {
                    alert('不是有效的图片文件!');
                    return;
                }
                // 读取文件:
                var reader = new FileReader();
                reader.onload = function(e) {
                    var data = e.target.result; // 'data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...'
                    preview.style.backgroundImage = "url(" + data + ")";
                };
                // 以DataURL的形式读取文件:
                reader.readAsDataURL(file);
            });
        });
    </script>
</block>


<block name="mainContent">
    <div class="content-wrapper">
        <section class="content-header">
            <h1>
                新建商品
            </h1>
            <ol class="breadcrumb">
                <li><a href="#"><i class="fa fa-gears"></i> 新建商品</a></li>
            </ol>
        </section>

        <section class="content">
            <div class="row">
                <section class="col-lg-12 connectedSortable">
                    <div>
                        <form id="commentForm" action="__URL__/saveProduct" enctype="multipart/form-data" method="post" >
                            <div class="form-group">
                                <input id="shangpinid" name="id" minlength="2" type="text" class="form-control"  value="{$productList['id']}" style="display:none"/>
                            </div>
                            <div>
                                <label for="name">商品名(必填项)</label>
                                <input id="name" name="name" minlength="3" type="text" class="form-control" value="{$productList['name']}" required/>
                            </div>
                            <div>
                                <label for="price">商品价格￥(必填项)</label>
                                <input id="price" type="number" name="price" class="form-control" value="{$productList['price']}" required/>
                            </div>
                            <div>
                                <label for="des">商品简介</label>
                                <textarea id="des" maxlength="30" type="text" name="introduce" style="resize:none;" class="form-control">{$productList['introduce']}</textarea>
                            </div>
                            <div>
                                <label for="des">商品缩略图(预览)</label>
                            </div>
                            <div id="test-image-preview" style="border: 1px solid black; width: 50%; height: 200px;background-repeat:no-repeat;">
                            </div>
                            <div>
                                <input type="file" id="test-image-file" name="photo" onchange="" class="btn btn-info btn-lg active" />
                            </div>
                            <div id="test-file-info">
                            </div>
                            <!--<input type="submit" value="提交" class="btn btn-success btn-lg active">-->
                            <button type="submit" class="btn btn-default">提交</button>
                        </form>
                    </div>
                </section>
            </div>
        </section>
    </div>
</block>